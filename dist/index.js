var X=Object.defineProperty;var Y=(u,t)=>{for(var n in t)X(u,n,{get:t[n],enumerable:!0})};var F={};Y(F,{Fraction:()=>g,Hap:()=>_,Pattern:()=>q,TimeSpan:()=>E,cat:()=>nt,fastcat:()=>W,polymeter:()=>it,pure:()=>Z,sequence:()=>et,slow:()=>rt,slowcat:()=>I,stack:()=>B});function G(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}function $(u,t,n){return n={path:t,exports:{},require:function(a,i){return K(a,i==null?n.path:i)}},u(n,n.exports),n.exports}function K(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var H=$(function(u,t){(function(n){var a=2e3,i={s:1,n:0,d:1};function N(r){function e(){var o=Error.apply(this,arguments);o.name=this.name=r,this.stack=o.stack,this.message=o.message}function s(){}return s.prototype=Error.prototype,e.prototype=new s,e}var d=c.DivisionByZero=N("DivisionByZero"),m=c.InvalidParameter=N("InvalidParameter");function v(r,e){return isNaN(r=parseInt(r,10))&&y(),r*e}function y(){throw new m}function j(r){for(var e={},s=r,o=2,l=4;l<=s;){for(;s%o==0;)s/=o,e[o]=(e[o]||0)+1;l+=1+2*o++}return s!==r?s>1&&(e[s]=(e[s]||0)+1):e[r]=(e[r]||0)+1,e}var b=function(r,e){var s=0,o=1,l=1,p=0,w=0,R=0,D=1,C=1,h=0,f=1,O=1,M=1,L=1e7,A;if(r!=null)if(e!==void 0)s=r,o=e,l=s*o;else switch(typeof r){case"object":{"d"in r&&"n"in r?(s=r.n,o=r.d,"s"in r&&(s*=r.s)):0 in r?(s=r[0],1 in r&&(o=r[1])):y(),l=s*o;break}case"number":{if(r<0&&(l=r,r=-r),r%1==0)s=r;else if(r>0){for(r>=1&&(C=Math.pow(10,Math.floor(1+Math.log(r)/Math.LN10)),r/=C);f<=L&&M<=L;)if(A=(h+O)/(f+M),r===A){f+M<=L?(s=h+O,o=f+M):M>f?(s=O,o=M):(s=h,o=f);break}else r>A?(h+=O,f+=M):(O+=h,M+=f),f>L?(s=O,o=M):(s=h,o=f);s*=C}else(isNaN(r)||isNaN(e))&&(o=s=NaN);break}case"string":if(f=r.match(/\d+|./g),f===null&&y(),f[h]==="-"?(l=-1,h++):f[h]==="+"&&h++,f.length===h+1?w=v(f[h++],l):f[h+1]==="."||f[h]==="."?(f[h]!=="."&&(p=v(f[h++],l)),h++,(h+1===f.length||f[h+1]==="("&&f[h+3]===")"||f[h+1]==="'"&&f[h+3]==="'")&&(w=v(f[h],l),D=Math.pow(10,f[h].length),h++),(f[h]==="("&&f[h+2]===")"||f[h]==="'"&&f[h+2]==="'")&&(R=v(f[h+1],l),C=Math.pow(10,f[h+1].length)-1,h+=3)):f[h+1]==="/"||f[h+1]===":"?(w=v(f[h],l),D=v(f[h+2],1),h+=3):f[h+3]==="/"&&f[h+1]===" "&&(p=v(f[h],l),w=v(f[h+2],l),D=v(f[h+4],1),h+=5),f.length<=h){o=D*C,l=s=R+o*p+C*w;break}default:y()}if(o===0)throw new d;i.s=l<0?-1:1,i.n=Math.abs(s),i.d=Math.abs(o)};function x(r,e,s){for(var o=1;e>0;r=r*r%s,e>>=1)e&1&&(o=o*r%s);return o}function J(r,e){for(;e%2==0;e/=2);for(;e%5==0;e/=5);if(e===1)return 0;for(var s=10%e,o=1;s!==1;o++)if(s=s*10%e,o>a)return 0;return o}function U(r,e,s){for(var o=1,l=x(10,s,e),p=0;p<300;p++){if(o===l)return p;o=o*10%e,l=l*10%e}return 0}function V(r,e){if(!r)return e;if(!e)return r;for(;;){if(r%=e,!r)return e;if(e%=r,!e)return r}}function c(r,e){if(!(this instanceof c))return new c(r,e);b(r,e),r=V(i.d,i.n),this.s=i.s,this.n=i.n/r,this.d=i.d/r}c.prototype={s:1,n:0,d:1,abs:function(){return new c(this.n,this.d)},neg:function(){return new c(-this.s*this.n,this.d)},add:function(r,e){return b(r,e),new c(this.s*this.n*i.d+i.s*this.d*i.n,this.d*i.d)},sub:function(r,e){return b(r,e),new c(this.s*this.n*i.d-i.s*this.d*i.n,this.d*i.d)},mul:function(r,e){return b(r,e),new c(this.s*i.s*this.n*i.n,this.d*i.d)},div:function(r,e){return b(r,e),new c(this.s*i.s*this.n*i.d,this.d*i.n)},clone:function(){return new c(this)},mod:function(r,e){return isNaN(this.n)||isNaN(this.d)?new c(NaN):r===void 0?new c(this.s*this.n%this.d,1):(b(r,e),i.n===0&&this.d===0&&c(0,0),new c(this.s*(i.d*this.n)%(i.n*this.d),i.d*this.d))},gcd:function(r,e){return b(r,e),new c(V(i.n,this.n)*V(i.d,this.d),i.d*this.d)},lcm:function(r,e){return b(r,e),i.n===0&&this.n===0?new c:new c(i.n*this.n,V(i.n,this.n)*V(i.d,this.d))},ceil:function(r){return r=Math.pow(10,r||0),isNaN(this.n)||isNaN(this.d)?new c(NaN):new c(Math.ceil(r*this.s*this.n/this.d),r)},floor:function(r){return r=Math.pow(10,r||0),isNaN(this.n)||isNaN(this.d)?new c(NaN):new c(Math.floor(r*this.s*this.n/this.d),r)},round:function(r){return r=Math.pow(10,r||0),isNaN(this.n)||isNaN(this.d)?new c(NaN):new c(Math.round(r*this.s*this.n/this.d),r)},inverse:function(){return new c(this.s*this.d,this.n)},pow:function(r,e){if(b(r,e),i.d===1)return i.s<0?new c(Math.pow(this.s*this.d,i.n),Math.pow(this.n,i.n)):new c(Math.pow(this.s*this.n,i.n),Math.pow(this.d,i.n));if(this.s<0)return null;var s=j(this.n),o=j(this.d),l=1,p=1;for(var w in s)if(w!=="1"){if(w==="0"){l=0;break}if(s[w]*=i.n,s[w]%i.d==0)s[w]/=i.d;else return null;l*=Math.pow(w,s[w])}for(var w in o)if(w!=="1"){if(o[w]*=i.n,o[w]%i.d==0)o[w]/=i.d;else return null;p*=Math.pow(w,o[w])}return i.s<0?new c(p,l):new c(l,p)},equals:function(r,e){return b(r,e),this.s*this.n*i.d==i.s*i.n*this.d},compare:function(r,e){b(r,e);var s=this.s*this.n*i.d-i.s*i.n*this.d;return(0<s)-(s<0)},simplify:function(r){if(isNaN(this.n)||isNaN(this.d))return this;var e=this.abs().toContinued();r=r||.001;function s(p){return p.length===1?new c(p[0]):s(p.slice(1)).inverse().add(p[0])}for(var o=0;o<e.length;o++){var l=s(e.slice(0,o+1));if(l.sub(this.abs()).abs().valueOf()<r)return l.mul(this.s)}return this},divisible:function(r,e){return b(r,e),!(!(i.n*this.d)||this.n*i.d%(i.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(r){var e,s="",o=this.n,l=this.d;return this.s<0&&(s+="-"),l===1?s+=o:(r&&(e=Math.floor(o/l))>0&&(s+=e,s+=" ",o%=l),s+=o,s+="/",s+=l),s},toLatex:function(r){var e,s="",o=this.n,l=this.d;return this.s<0&&(s+="-"),l===1?s+=o:(r&&(e=Math.floor(o/l))>0&&(s+=e,o%=l),s+="\\frac{",s+=o,s+="}{",s+=l,s+="}"),s},toContinued:function(){var r,e=this.n,s=this.d,o=[];if(isNaN(e)||isNaN(s))return o;do o.push(Math.floor(e/s)),r=e%s,e=s,s=r;while(e!==1);return o},toString:function(r){var e=this.n,s=this.d;if(isNaN(e)||isNaN(s))return"NaN";r=r||15;var o=J(e,s),l=U(e,s,o),p=this.s===-1?"-":"";if(p+=e/s|0,e%=s,e*=10,e&&(p+="."),o){for(var w=l;w--;)p+=e/s|0,e%=s,e*=10;p+="(";for(var w=o;w--;)p+=e/s|0,e%=s,e*=10;p+=")"}else for(var w=r;e&&w--;)p+=e/s|0,e%=s,e*=10;return p}},Object.defineProperty(c,"__esModule",{value:!0}),c.default=c,c.Fraction=c,u.exports=c})()}),P=G(H),g=P;var tt=function(u){return u.filter(t=>t!=null)};function Q(u){return[].concat(...u)}var S=u=>u;g.prototype.sam=function(){return g(Math.floor(this))};g.prototype.nextSam=function(){return this.sam().add(1)};g.prototype.wholeCycle=function(){return new E(this.sam(),this.nextSam())};g.prototype.lt=function(u){return this.compare(u)<0};g.prototype.gt=function(u){return this.compare(u)>0};g.prototype.lte=function(u){return this.compare(u)<=0};g.prototype.gte=function(u){return this.compare(u)>=0};g.prototype.max=function(u){return this.gt(u)?this:u};g.prototype.min=function(u){return this.lt(u)?this:u};g.prototype.show=function(){return this.n+"/"+this.d};var E=class{constructor(t,n){this.begin=g(t),this.end=g(n)}get spanCycles(){for(var t=[],n=this.begin,a=this.end,i=a.sam();a.gt(n);){if(n.sam().equals(i)){t.push(new E(n,this.end));break}var N=n.nextSam();t.push(new E(n,N)),n=N}return t}withTime(t){return new E(t(this.begin),t(this.end))}intersection(t){var n=this.begin.max(t.begin),a=this.end.min(t.end);if(!n.gt(a)&&!(n.equals(a)&&(n.equals(this.end)&&this.begin.lt(this.end)||n.equals(t.end)&&t.begin.lt(t.end))))return new E(n,a)}intersection_e(t){var n=this.intersection(t);return n==null,n}get midpoint(){return this.begin.add(this.end.sub(this.begin).div(g(2)))}equals(t){return this.begin.equals(t.begin)&&this.end.equals(t.end)}show(){return this.begin.show()+" -> "+this.end.show()}},_=class{constructor(t,n,a){this.whole=t,this.part=n,this.value=a}withSpan(t){var n=this.whole?t(this.whole):void 0;return new _(n,t(this.part),this.value)}withValue(t){return new _(this.whole,this.part,t(this.value))}hasOnset(){return this.whole!=null&&this.whole.begin.equals(this.part.begin)}spanEquals(t){return this.whole==null&&t.whole==null||this.whole.equals(t.whole)}equals(t){return this.spanEquals(t)&&this.part.equals(t.part)&&this.value===t.value}show(){return"("+(this.whole==null?"~":this.whole.show())+", "+this.part.show()+", "+this.value+")"}},q=class{constructor(t){this.query=t}_splitQueries(){var t=this,n=function(a){return Q(a.spanCycles.map(i=>t.query(i)))};return new q(n)}withQuerySpan(t){return new q(n=>this.query(t(n)))}withQueryTime(t){return new q(n=>this.query(n.withTime(t)))}withEventSpan(t){return new q(n=>this.query(n).map(a=>a.withSpan(t)))}withEventTime(t){return this.withEventSpan(n=>n.withTime(t))}withValue(t){return new q(n=>this.query(n).map(a=>a.withValue(t)))}fmap(t){return this.withValue(t)}_filterEvents(t){return new q(n=>this.query(n).filter(t))}_filterValues(t){return new q(n=>this.query(n).filter(a=>t(a.value)))}onsetsOnly(){return this._filterEvents(t=>t.hasOnset())}_appWhole(t,n){var a=this;return query=function(i){var N=a.query(i),d=n.query(i);return apply=function(m,v){var y=m.part.intersection(v.part);if(y!=null)return new _(t(m.whole,v.whole),y,m.value(v.value))},Q(N.map(m=>tt(d.map(v=>apply(m,v)))))},new q(query)}appBoth(t){var n=function(a,i){if(!(a==null||span_B==null))return a.intersection_e(i)};return this._appWhole(n,t)}appLeft(t){var n=this,a=function(i){var N=[];for(var d of n.query(i)){var m=t.query(d.part);for(var v of m){var y=d.whole,j=d.part.intersection_e(v.part),b=d.value(v.value),x=new _(y,j,b);N.push(x)}}return N};return new q(a)}appRight(t){var n=this,a=function(i){var N=[];for(var d of t.query(i)){var m=n.query(d.part);for(var v of m){var y=d.whole,j=v.part.intersection_e(d.part),b=v.value(d.value),x=new _(y,j,b);N.push(x)}}return N};return new q(a)}get firstCycle(){return this.query(new E(g(0),g(1)))}_opleft(t,n){return this.fmap(n).appLeft(k(t))}add(t){return this._opleft(t,n=>a=>n+a)}sub(t){return this._opleft(t,n=>a=>n-a)}union(t){return this._opleft(t,n=>a=>Object.assign({},n,a))}_bindWhole(t,n){var a=this,i=function(N){var d=function(v,y){return new _(t(v.whole,y.whole),y.part,y.value)},m=function(v){return n(v.value).query(v.part).map(y=>d(v,y))};return Q(a.query(N).map(m))};return new q(i)}bind(t){var n=function(a,i){if(!(a==null||i==null))return a.intersection_e(i)};return this._bindWhole(n,t)}join(){return this.bind(S)}innerBind(t){return this._bindWhole((n,a)=>n,t)}innerJoin(){return this.innerBind(S)}outerBind(t){return this._bindWhole((n,a)=>a,t)}outerJoin(){return this.outerBind(S)}_fast(t){var n=this.withQueryTime(a=>a.mul(t));return n.withEventTime(a=>a.div(t))}_slow(t){return this._fast(1/t)}_early(t){return t=g(t),this.withQueryTime(n=>n.add(t)).withEventTime(n=>n.sub(t))}_late(t){return this._early(0-t)}when(t,n){var a=t._filterValues(S),i=t._filterValues(m=>!m),N=a.fmap(m=>v=>v).appRight(n(this)),d=i.fmap(m=>v=>v).appRight(this);return B([N,d])}off(t,n){return B([this,n(this._early(t))])}off(t,n){return B(this,n(this.early(t)))}every(t,n){return pats=Array(t-1).fill(this),pats.unshift(this),I(pats)}append(t){return W([this,t])}rev(){var t=this,n=function(a){var i=a.begin.sam(),N=a.begin.nextSam(),d=function(v){var y=v.withTime(b=>i.add(N.sub(b))),j=y.begin;return y.begin=y.end,y.end=j,y},m=t.query(d(a));return m.map(v=>v.withSpan(d))};return new q(n)._splitQueries()}jux(t,n=1){n/=2;var a=function(d,m,v){return m in d?d[m]:v},i=this.withValue(d=>Object.assign({},d,{pan:a(d,"pan",.5)-n})),N=this.withValue(d=>Object.assign({},d,{pan:a(d,"pan",.5)+n}));return B([i,t(N)])}};function k(u){return u.constructor.name=="Pattern"?u:Z(u)}function Z(u){function t(n){return n.spanCycles.map(a=>new _(g(a.begin).wholeCycle(),a,u))}return new q(t)}function B(u){var u=u.map(k),t=function(n){return Q(u.map(a=>a.query(n)))};return new q(t)}function I(u){var t=function(n){var a=u[Math.floor(n.begin)%u.length];return a.query(n)};return new q(t)._splitQueries()}function rt(...u){return u=u.map(t=>k(t)),I(u)}function W(u){return I(u)._fast(u.length)}function nt(u){return W(u)}function T(u){return Array.isArray(u)?u.length==0?[z(),0]:u.length==1?T(u[0]):[W(u.map(t=>T(t)[0])),u.length]:[k(u),1]}function et(...u){return T(u)[0]}function it(u=0,...t){var n=t.map(T);if(n.length==0)return z();u==0&&(u=n[0][1]);var a=[];for(var i of n)i[1]==0&&next,u==i[1]?a.push(i[0]):a.push(i[0]._fast(g(u).div(g(i[1]))));return B(a)}function z(){return new q(u=>[])}window.strudel=F;
/**
 * @license Fraction.js v4.1.2 23/05/2021
 * https://www.xarg.org/2014/03/rational-numbers-in-javascript/
 *
 * Copyright (c) 2021, Robert Eisele (robert@xarg.org)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 **/
//# sourceMappingURL=index.js.map
